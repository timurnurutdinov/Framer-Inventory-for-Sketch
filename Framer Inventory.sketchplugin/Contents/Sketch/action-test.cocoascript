@import 'inventory/layer-compilation.cocoascript'
@import 'framer-inventory-search.cocoascript'

var onRun = function(context) {
	var doc = context.document
	var selection = context.selection
	var layerCompilationCollection = []
	var pasteboardContent = []
	var retinaProperty = 2

	if (selection != nil) {
		for (var i = 0; i < [selection count]; i++) {
			var currentLayer = [selection objectAtIndex: i]
			var layerCompilation = new LayerCompilation(currentLayer, retinaProperty)
			layerCompilation.addState(currentLayer)
			layerCompilationCollection.push(layerCompilation)
		}
	}
	
	log("LENGTH IS " + [layerCompilationCollection.length])
	for (var i = 0; i < [layerCompilationCollection.length]; i++) {
		pasteboardContent += layerCompilationCollection[i].printCompilation()
	}
	
	[[NSPasteboard generalPasteboard] clearContents];
	[[NSPasteboard generalPasteboard] setString:pasteboardContent  forType:NSStringPboardType];
	[doc showMessage:"Done"]
}
	